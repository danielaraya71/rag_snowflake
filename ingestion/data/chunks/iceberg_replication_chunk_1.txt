ADMIN
;
SELECT
SYSTEM$GLOBAL_ACCOUNT_SET_PARAMETER
(
'<organization_name>.<account_name>'
,
'ENABLE_ACCOUNT_DATABASE_REPLICATION'
,
'true'
);
Copy
For more information, see
Prerequisite: Enable replication for accounts in the organization
.
For more information about replication, see
Introduction to replication and failover across multiple accounts
.
Replicate an external volume by using a failover group
¶
These steps provide a sample workflow for replicating an external volume and the Iceberg tables that depend on it
to a target account by using a failover group.
Note
If you don’t already have an external volume, you can create one with the storage locations that you want, including a
location
in the same region
as your target account. After configuring storage access for each location,
you can create and replicate an Iceberg table that references the external volume.
To create an external volume, see
Configure an external volume
.
In the source account, update your external volume to add a storage location
in the same region
as your target account.
For example:
ALTER
EXTERNAL VOLUME
exvol1
ADD
STORAGE_LOCATION
=
(
NAME
=
'my-s3-us-central-2'
STORAGE_PROVIDER
=
'S3'
STORAGE_BASE_URL
=
's3://my_bucket_us_central-2/'
STORAGE_AWS_ROLE_ARN
=
'arn:aws:iam::123456789012:role/myrole'
STORAGE_AWS_EXTERNAL_ID
=
'iceberg_table_external_id'
);
Copy
Important
If you don’t specify your own
STORAGE_AWS_EXTERNAL_ID
for S3 storage, you must call
DESCRIBE EXTERNAL VOLUME
after you
add the new storage location to retrieve the Snowflake-generated external ID.
You need the external ID to configure access to S3 in the next step.
Snowflake sets this new location as the
active storage location
for the secondary
external volume.
In the source account, create a Snowflake-managed Iceberg table that uses the external volume that you updated with the additional storage
location.
For example:
CREATE
ICEBERG
TABLE
my_iceberg_table
(
amount
int
)
CATALOG
=
'SNOWFLAKE'
EXTERNAL_VOLUME
=
'exvol1'
BASE_LOCATION
=
'my_iceberg_table'
;
Copy
In the source account, retrieve
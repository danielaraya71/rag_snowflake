 specific failover group
myfg
:
SELECT
phase_name
,
start_time
,
job_uuid
FROM
TABLE
(
INFORMATION_SCHEMA
.
REPLICATION_GROUP_REFRESH_HISTORY
(
'myfg'
))
WHERE
phase_name
<>
'COMPLETED'
and
phase_name
<>
'CANCELED'
;
Copy
Cancel the refresh operation using the SYSTEM$CANCEL_QUERY function and the QUERY_ID or JOB_UUID:
SELECT
SYSTEM$CANCEL_QUERY
(
'<QUERY_ID | JOB_UUID>'
);
Copy
Returns the following output:
query [<QUERY_ID>] terminated.
After you cancel the in-progress refresh operation, continue to the
next steps
.
Reopen active channels for Snowpipe Streaming in newly promoted source account
¶
Tables in a primary database that are populated by
Snowpipe Streaming are replicated
to secondary databases. After failover, reopen active Snowpipe Streaming channels for tables and re-insert any missing data rows
for the channels:
Reopen active channels for the table by calling the
openChannel
API.
Fetch offset tokens:
Call the
getLatestCommittedOffsetToken
API
or
Execute the
SHOW CHANNELS
command to retrieve a list of the active channels of the table.
Re-insert data rows for the channel from the fetched offset tokens.
Note
These steps apply only to Snowpipe Streaming with the Snowflake Ingest SDK; it doesn’t apply to Snowpipe Streaming with the Kafka connector. Follow
the steps below
to restart the Kafka Connector after failover.
Snowpipe Streaming and the Kafka connector
¶
If you are using the Kafka connector and Snowpipe Streaming, follow these steps after failover:
Update the Kafka connector configuration to point to the newly promoted source account.
Execute the SHOW CHANNELS command to retrieve the list of active channels and the offset tokens. Each channel belongs to a
single partition in the Kafka topic.
Manually reset offsets in the Kafka Topic for each of those partitions (channels).
Restart the Kafka Connector.
For more information, see:
Using Snowflake Connector for Kafka with Snowpipe Streaming Classic
.
Replication and Snowpipe Streaming
.
On this page
Prerequisites
Promote a target account to serve as the source account
Promote a target account to serve as the source account using Snowsight
Promote a single failover group to serve as the primary using Snowsight
Promote a target account to serve as the source account using SQL
View the current phase of an in